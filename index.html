<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Apprenants</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .modal-section {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1050;
            overflow-y: auto;
        }
        .modal-content {
            position: relative;
            background-color: white;
            margin: 50px auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 800px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .btn-close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Styles pour les diff√©rentes sections */
        .page-section {
            display: none;
        }
        
        .active-section {
            display: block;
        }
        
        /* Login √©tudiant */
        .login-section .left-section {
            background-color: #708090;
            min-height: 100vh;
            padding: 50px 20px;
        }
        
        .login-section .left-section h2 {
            font-size: 38px;
            font-weight: bold;
            color: rgb(47, 207, 56);
        }
        
        .login-section .right-img {
            background: url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') center/cover;
            min-height: 100vh;
        }
        
        /* Dashboard √©tudiant */
        .dashboard-section {
            background-color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Statistiques */
        .stats-section .stat-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats-section .stat-table th {
            background-color: #f8f9fa;
            text-align: center;
            padding: 15px;
            border: 1px solid #dee2e6;
            font-weight: 600;
            width: 25%;
        }
        
        .stats-section .stat-table td {
            text-align: center;
            padding: 30px 15px;
            border: 1px solid #dee2e6;
        }
        
        .stats-section .stat-value {
            color: #2c3e50;
            font-size: 2rem;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        
        .stats-section .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        /* Profile √©tudiant */
        .profile-section {
            background: url('https://images.unsplash.com/photo-1514826786317-59744fe2a548?auto=format&fit=crop&w=1200&q=80') center/cover no-repeat;
            min-height: 100vh;
            backdrop-filter: blur(4px);
        }
        
        .profile-box {
            background: rgba(0, 0, 0, 0.45);
            color: white;
            border-radius: 15px;
            padding: 40px;
            margin-top: 40px;
        }
        
        .profile-img {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 110px;
            color: black;
            margin: auto;
        }
        
        /* Historique √©tudiant */
        .history-section {
            background-color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .graph-wrapper {
            height: 400px;
            width: 100%;
            position: relative;
        }
    </style>
</head>
<body class="bg-light">
    <!-- ====================== SECTION PRINCIPALE (TABLEAU) ====================== -->
    <div id="section-tableau" class="page-section active-section">
        <div class="container my-5">
            <!-- Header avec titre et boutons -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="text-center bg-secondary text-white p-2 rounded">
                    Gestion des Apprenants
                </h2>
                <div class="d-flex gap-1">
                    <button class="btn btn-primary" id="btn-ajouter">
                        <i class="bi bi-plus-circle"></i> Ajouter un √©tudiant
                    </button>
                    <button class="btn btn-info text-white" id="btn-absence">
                        <i class="bi bi-person-check"></i> Prise de pr√©sence
                    </button>
                    <button class="btn btn-secondary" id="btn-historique">
                        <i class="bi bi-clock-history"></i> Historique
                    </button>
                    <button class="btn btn-secondary" id="btn-studentspace">
                        <i class="bi bi-person"></i> Espace √©tudiant
                    </button>
                </div>
            </div>

            <!-- Tableau des √©tudiants -->
            <table class="table table-bordered table-striped table-hover" id="table-etudiant">
                <thead class="table-dark">
                    <tr>
                        <th>Nom</th>
                        <th>Pr√©nom</th>
                        <th>Groupe</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Les √©tudiants seront ajout√©s dynamiquement -->
                </tbody>
            </table>

            <!-- Boutons lat√©raux -->
            <div class="row mt-4">
                <div class="col-md-3">
                    <div class="side-buttons d-flex flex-column gap-2">
                        <button class="btn btn-primary" id="btn-historique-2">
                            <i class="bi bi-clock-history"></i> Historique
                        </button>
                        <button class="btn btn-info text-white" id="btn-absence-2">
                            <i class="bi bi-person-check"></i> Prise de pr√©sence
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION PRISE DE PR√âSENCE ====================== -->
    <div id="section-presence" class="page-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="retourTableau()">
                <i class="bi bi-arrow-left"></i> Retour au tableau
            </button>

            <h2 class="text-center text-black mt-4">
                Prise de pr√©sence
            </h2>

            <div class="card shadow mt-4 mx-auto" style="max-width: 800px;">
                <div class="card-body">
                    <table class="table table-bordered text-center" id="tableau-presence">
                        <thead class="table-light">
                            <tr>
                                <th>√âl√®ve</th>
                                <th>Pr√©sent</th>
                                <th>Absent</th>
                                <th>En retard</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Les √©tudiants seront ajout√©s dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION HISTORIQUE ====================== -->
    <div id="section-historique" class="page-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="retourTableau()">
                <i class="bi bi-arrow-left"></i> Retour au tableau
            </button>

            <div class="justify-content-center shadow-lg border-3">
                <div class="bg-secondary text-center p-3 rounded">
                    <h2 class="text-white">Gestion des Apprenants</h2>
                    <h4 class="text-white mt-3">Historique d'activit√©s</h4>
                </div>
                
                <div class="mt-4">
                    <table class="table table-striped table-hover" id="table-historique">
                        <thead class="table-dark">
                            <tr>
                                <th>Date</th>
                                <th>Nombre d'absents</th>
                                <th>Nombre de retards</th>
                                <th>D√©tails</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- L'historique sera ajout√© dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION D√âTAILS DU JOUR ====================== -->
    <div id="section-details" class="page-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="afficherHistorique()">
                <i class="bi bi-arrow-left"></i> Retour √† l'historique
            </button>

            <div class="d-flex flex-column align-items-center mt-4">
                <h2 class="text-left">D√©tails du jour : <span id="date-details" class="text-primary">Date</span></h2>
            </div>

            <div class="container mt-4">
                <table class="table table-striped table-hover" id="table-details-jour">
                    <thead class="table-dark">
                        <tr>
                            <th>Absents</th>
                            <th>Retardataires</th>
                            <th>Heure d'arriv√©e</th>
                            <th>Motif</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Les d√©tails seront ajout√©s dynamiquement -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION LOGIN √âTUDIANT ====================== -->
    <div id="section-login" class="page-section login-section">
        <div class="container-fluid p-0">
            <div class="row g-0">
                <div class="left-section col-md-6 text-center pt-4">
                    <button class="btn btn-secondary mb-3" onclick="retourTableau()">
                        <i class="bi bi-arrow-left"></i> Retour
                    </button>
                    
                    <h2>Espace Apprenant</h2>

                    <form class="mt-4">
                        <label class="mb-2">Entrer votre pr√©nom</label>
                        <input type="text" id="userinput1" class="form-control w-50 mx-auto mb-3" placeholder="Pr√©nom...">

                        <label class="mb-2">Entrer votre Nom</label>
                        <input type="text" id="userinput2" class="form-control w-50 mx-auto mb-3" placeholder="Nom...">

                        <label class="mb-2">Entrer votre Groupe</label>
                        <input type="text" id="userinput3" class="form-control w-50 mx-auto mb-3" placeholder="Groupe...">

                        <p id="login-result" class="mt-3"></p>

                        <button type="button" class="btn btn-primary px-4 py-2 rounded-pill" onclick="verifierLogin()">
                            Se connecter
                        </button>
                    </form>
                                            

                </div>

                <div class="col-md-6 right-img"> 
                     <!-- ===============Image de droite  backround===================-->
                            <img src="image.jpg" alt="Description de l'image" style="width: 100%; max-width: 750px;">
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION DASHBOARD √âTUDIANT ====================== -->
    <div id="section-dashboard" class="page-section dashboard-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="retourLogin()">
                <i class="bi bi-arrow-left"></i> Retour
            </button>
            
            <div class="d-flex justify-content-center m-4 bg-light w-100">
                <h4 class="text-center">Bonjour, bienvenue dans votre espace apprenant</h4>
            </div>

            <div class="d-flex justify-content-evenly align-items-center m-5">
                <button class="btn btn-primary" onclick="afficherProfil()">Profil</button>
                <button class="btn btn-primary" onclick="afficherHistoriqueEtudiant()">Historique</button>
                <button class="btn btn-primary" onclick="afficherStatistiquesEtudiant()">Statistiques</button>
            </div>

            <div class="rounded-3 bg-info w-50 mx-auto p-3">
                <div class="d-flex align-items-center">
                    <h4 class="m-3">Nom:</h4>
                    <h3 id="dashNom">-</h3>
                </div>
                <div class="d-flex align-items-center">
                    <h4 class="m-3">Pr√©nom:</h4>
                    <h3 id="dashPrenom">-</h3>
                </div>
                <div class="d-flex align-items-center">
                    <h4 class="m-3">Groupe:</h4>
                    <h3 id="dashGroupe">-</h3>
                </div>
            </div>

            <div class="bg-secondary w-75 mx-auto m-5 rounded-3 p-3">
                <div class="row mb-2">
                    <h4 class="col-6">Total de jours enregistr√©s:</h4>
                    <h5 class="col-6 text-end" id="dashTotalJours">0</h5>
                </div>
                <div class="row mb-2">
                    <h4 class="col-6">Nombre d'absences:</h4>
                    <h5 class="col-6 text-end" id="dashAbsences">0</h5>
                </div>
                <div class="row mb-2">
                    <h4 class="col-6">Nombre de retards:</h4>
                    <h5 class="col-6 text-end" id="dashRetards">0</h5>
                </div>
                <div class="row mb-2">
                    <h4 class="col-6">Taux de pr√©sence (%):</h4>
                    <h5 class="col-6 text-end" id="dashTauxPresence">0%</h5>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION PROFIL √âTUDIANT ====================== -->
    <div id="section-profil" class="page-section profile-section">
        <div class="container">
            <button class="btn btn-light mb-3 mt-3" onclick="retourDashboard()">
                <i class="bi bi-arrow-left"></i> Retour
            </button>
            
            <div class="profile-box text-center">
                <div class="profile-img mb-3">
                    üë§
                </div>
                <h2 class="text-primary fw-bold">Profile :</h2>
                <h3 class="text-white mb-4" id="profile-welcome">Bienvenue !</h3>
                <div class="d-flex justify-content-center gap-4 flex-wrap">
                    <span>üçÄ<span id="profile-prenom" class="text-info">-</span></span>
                    <span>üçÄ<span id="profile-nom" class="text-info">-</span></span>
                    <span>üçÄ<span id="profile-groupe" class="text-info">-</span></span>
                </div>
                <h4 class="mt-5">Le Statut Global Par Mois :</h4>
                <p id="profile-statut" class="fw-bold fs-4 text-warning">En cours de calcul...</p>
                <div class="details" id="profile-details">
                    <h3>D√©tails</h3>
                    <span class="me-2 text-primary">- Le Nombre D'absences Est : 
                        <span id="profile-absences" class="text-info me-3">0</span>
                    </span>
                    <span class="me-2 text-primary">- Le Nombre De retards Est : 
                        <span id="profile-retards" class="text-info me-3">0</span>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION STATISTIQUES √âTUDIANT ====================== -->
    <div id="section-statistiques" class="page-section stats-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="retourDashboard()">
                <i class="bi bi-arrow-left"></i> Retour
            </button>

            <!-- Titre principal -->
            <div class="text-center mb-4">
                <h1 class="text-dark mb-2">
                    <i class="bi bi-person-badge"></i>
                    Gestion des Apprenants
                </h1>
                <p class="text-muted">Statistiques personnelles sur les 30 derniers jours</p>
            </div>

            <!-- Info √©tudiant -->
            <div class="student-info bg-light p-3 rounded mb-4 text-center">
                <div class="student-name fw-bold" id="stats-student-name">Chargement...</div>
                <div class="student-group text-muted" id="stats-student-info"></div>
                <div class="text-muted small mt-2" id="stats-periode"></div>
            </div>

            <!-- Tableau des indicateurs -->
            <h3 class="stat-header bg-dark text-white p-3 rounded-top text-center">
                <i class="bi bi-clipboard-data"></i>
                Statistiques personnelles (Indicateurs)
            </h3>
            
            <table class="stat-table">
                <thead>
                    <tr>
                        <th>Taux de retard (%)</th>
                        <th>Nombre de jours pr√©sents (j)</th>
                        <th>Taux d'absence (%)</th>
                        <th>Heure moyenne d'arriv√©e en retard</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <span class="stat-value" id="stats-taux-retard">0</span>
                            <span class="stat-label">Taux de retard</span>
                        </td>
                        <td>
                            <span class="stat-value" id="stats-jours-presents">0</span>
                            <span class="stat-label">Jours pr√©sents</span>
                        </td>
                        <td>
                            <span class="stat-value" id="stats-taux-absence">0</span>
                            <span class="stat-label">Taux d'absence</span>
                        </td>
                        <td>
                            <span class="stat-value" id="stats-heure-moyenne">00:00</span>
                            <span class="stat-label">Heure moyenne</span>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Graphique unique -->
            <div class="graph-container bg-white p-4 rounded-bottom shadow">
                <h4 class="graph-title text-center mb-4">
                    <i class="bi bi-bar-chart-line"></i>
                    Vue d'ensemble des statistiques
                </h4>
                
                <div class="graph-wrapper">
                    <canvas id="stats-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- ====================== SECTION HISTORIQUE √âTUDIANT ====================== -->
    <div id="section-historique-etudiant" class="page-section history-section">
        <div class="container my-5">
            <button class="btn btn-secondary mb-3" onclick="retourDashboard()">
                <i class="bi bi-arrow-left"></i> Retour
            </button>

            <h2 class="text-center mb-4">Historique des pr√©sences</h2>
            
            <div class="table-responsive">
                <table class="table table-striped" id="table-historique-etudiant">
                    <thead class="table-dark">
                        <tr>
                            <th>Date</th>
                            <th>Statut</th>
                            <th>Heure</th>
                            <th>D√©tails</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- L'historique sera ajout√© dynamiquement -->
                    </tbody>
                </table>
            </div>
            
            <div class="text-center mt-4" id="historique-vide">
                <p class="text-muted">Aucun historique disponible</p>
            </div>
        </div>
    </div>

    <!-- ====================== MODALES ====================== -->
    <!-- Modale confirmation suppression -->
    <div id="modal-confirmation" class="modal-section">
        <div class="modal-content" style="max-width: 500px;">
            <button class="btn-close-modal" onclick="cacherModal('confirmation')">&times;</button>
            
            <div class="text-center">
                <h5 class="mb-3">Voulez-vous supprimer cet √©tudiant ?</h5>
                <p class="text-muted mb-4">Cette action est irr√©versible</p>

                <div class="d-flex justify-content-center gap-3">
                    <button class="btn btn-danger px-4" id="btnOui">
                        <i class="bi bi-check-circle"></i> OUI
                    </button>
                    <button class="btn btn-secondary px-4" id="btnNon">
                        <i class="bi bi-x-circle"></i> NON
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale modifier √©tudiant -->
    <div id="modal-modifier" class="modal-section">
        <div class="modal-content">
            <button class="btn-close-modal" onclick="cacherModal('modifier')">&times;</button>
            <div class="d-flex flex-column align-items-center mb-4">
                <h2>Modifier un apprenant</h2>
            </div>
            <form action="" class="p-4 border rounded" style="background-color: #f8f9fa;">
                <div class="row mb-3">
                    <div class="col-sm-4">
                        <label for="apprenantName" class="form-label">Nom de l'apprenant</label>
                    </div>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="apprenantName" placeholder="Entrez le nom de l'apprenant">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4">
                        <label for="apprenantPrenom" class="form-label">Pr√©nom de l'apprenant</label>
                    </div>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="apprenantPrenom" placeholder="Entrez le pr√©nom de l'apprenant">
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-sm-4">
                        <label for="typeofthegroup">Num√©ro du groupe</label>
                    </div>
                    <div class="col-sm-8">
                        <select id="typeofthegroup" class="form-select">
                            <option value="G1">G1</option>
                            <option value="G2">G2</option>
                            <option value="G3">G3</option>
                            <option value="G4">G4</option>
                        </select>
                    </div>
                </div>
                <div class="d-flex mt-3 mb-3 justify-content-center gap-3">
                    <button type="button" id="btnmodifie" class="btn btn-success">
                        <i class="bi bi-check-circle"></i> Modifier
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="cacherModal('modifier')">
                        <i class="bi bi-x-circle"></i> Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modale ajouter √©tudiant -->
    <div id="modal-ajouter" class="modal-section">
        <div class="modal-content">
            <button class="btn-close-modal" onclick="cacherModal('ajouter')">&times;</button>
            <div class="d-flex flex-column align-items-center mb-4">
                <h2>Ajouter un nouvel apprenant</h2>
            </div>
            <form action="" class="p-4 border rounded" style="background-color: #f8f9fa;">
                <div class="row mb-3">
                    <div class="col-sm-4">
                        <label for="nouveauNom" class="form-label">Nom de l'apprenant</label>
                    </div>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="nouveauNom" placeholder="Entrez le nom de l'apprenant">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4">
                        <label for="nouveauPrenom" class="form-label">Pr√©nom de l'apprenant</label>
                    </div>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="nouveauPrenom" placeholder="Entrez le pr√©nom de l'apprenant">
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-sm-4">
                        <label for="nouveauGroupe">Num√©ro du groupe</label>
                    </div>
                    <div class="col-sm-8">
                        <select id="nouveauGroupe" class="form-select">
                            <option value="G1">G1</option>
                            <option value="G2">G2</option>
                            <option value="G3">G3</option>
                            <option value="G4">G4</option>
                        </select>
                    </div>
                </div>
                <div class="d-flex mt-3 mb-3 justify-content-center gap-3">
                    <button type="button" id="btn-ajouter-form" class="btn btn-primary">
                        <i class="bi bi-plus-circle"></i> Ajouter
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="cacherModal('ajouter')">
                        <i class="bi bi-x-circle"></i> Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modale d√©tails retard -->
    <div id="modal-retard-details" class="modal-section">
        <div class="modal-content" style="max-width: 600px;">
            <button class="btn-close-modal" onclick="cacherModal('retard-details')">&times;</button>
            <div class="d-flex flex-column align-items-center mb-4">
                <h2>Enregistrer un retard</h2>
            </div>
            <div class="p-4 border rounded" style="background-color: #f8f9fa;">
                <div class="mb-3">
                    <label class="form-label">√âtudiant</label>
                    <p class="form-control-static fw-bold" id="nomRetard">Nom Pr√©nom</p>
                </div>
                <div class="mb-3">
                    <label for="heureArrivee" class="form-label">Heure d'arriv√©e</label>
                    <input type="time" class="form-control" id="heureArrivee">
                </div>
                <div class="mb-4">
                    <label for="motifRetard" class="form-label">Motif du retard</label>
                    <textarea class="form-control" id="motifRetard" rows="3" placeholder="Raison du retard..."></textarea>
                </div>
                <div class="d-flex mt-3 mb-3 justify-content-center gap-3">
                    <button type="button" id="btn-enregistrer-retard" class="btn btn-warning">
                        <i class="bi bi-clock-history"></i> Enregistrer le retard
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="cacherModal('retard-details')">
                        <i class="bi bi-x-circle"></i> Annuler
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="script.js"></script>
</body>
</html>